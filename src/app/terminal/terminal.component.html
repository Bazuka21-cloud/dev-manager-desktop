<div class="w-100 h-100 d-flex flex-column">
  <ul ngbNav #nav="ngbNav" class="nav-tabs flex-shrink-0 mt-2 px-2" [animation]="false" [(activeId)]="currentShell">
    <li *ngFor="let shell of shells; trackBy:shellTracker" [ngbNavItem]="shell.token" [destroyOnHide]="false">
      <a ngbNavLink>
        {{shell.title}}
        <span class="close position-relative ps-2 font-weight-light"
              (click)="closeSession($event, shell.token)">Ã—</span>
      </a>
      <ng-template ngbNavContent [ngSwitch]="shell.hasPty">
        <app-terminal-pty class="terminal-tab" [token]="shell.token" *ngSwitchCase="true"></app-terminal-pty>
        <app-terminal-dumb class="terminal-tab" [token]="shell.token" *ngSwitchDefault></app-terminal-dumb>
      </ng-template>
    </li>
    <li>
    </li>
    <li class="nav-item">
      <div class="btn-group btn-group-sm mt-1 ms-2" role="group" aria-label="New Tab">
        <button type="button" class="btn btn-secondary" (click)="newTab()">
          <i class="bi bi-plus-lg"></i>
        </button>
        <div class="btn-group btn-group-sm" ngbDropdown role="group" aria-label="Button group with nested dropdown">
          <button type="button" class="btn btn-secondary" ngbDropdownToggle>
          </button>
          <div class="dropdown-menu" ngbDropdownMenu>
            <div class="dropdown-item-text d-flex flex-row text-nowrap">
              <label class="form-check-label" for="useDumbShell">Prefer dumb shell</label>
              <input type="checkbox" class="form-check-input ms-3" id="useDumbShell" [(ngModel)]="preferDumbShell">
            </div>
            <div class="dropdown-divider"></div>
            <button ngbDropdownItem *ngFor="let device of (deviceManager.devices$ | async)"
                    (click)="newTab(device)">{{device.name}}</button>
          </div>
        </div>
      </div>
    </li>
  </ul>

  <div class="overflow-hidden flex-fill position-relative">
    <div class="position-absolute w-100 h-100">
      <app-terminal-pty (termSizeChanged)="termSize = $event"></app-terminal-pty>
    </div>
    <div class="position-absolute w-100 h-100 tabs-container" [ngbNavOutlet]="nav"></div>
  </div>
</div>
